<div class="login-wrapper">
  <div class="login-card">
    <div class="rainbow-bar"></div>

    <ul class="nav nav-pills nav-fill toggle-nav">
      <li class="nav-item">
        <button class="nav-link" [class.active]="mode==='login'" (click)="setMode('login')">
          Login
        </button>
      </li>
      <li class="nav-item">
        <button class="nav-link" [class.active]="mode==='register'" (click)="setMode('register')">
          Register
        </button>
      </li>
    </ul>

    <form *ngIf="mode==='login'" [formGroup]="loginForm" (ngSubmit)="submitLogin()" class="login-form">
      <label>Username or Email</label>
      <input class="form-control" formControlName="usernameOrEmail" />
      <div *ngIf="loginForm.controls['usernameOrEmail'].touched && loginForm.controls['usernameOrEmail'].invalid"
           class="error-text">Username or email is required.</div>

      <label>Password</label>
      <input type="password" class="form-control" formControlName="password" />
      <div *ngIf="loginForm.controls['password'].touched && loginForm.controls['password'].invalid"
           class="error-text">This field is required.</div>

      <button class="btn btn-primary w-100" type="submit">
        Login
      </button>
    </form>

    <form *ngIf="mode==='register'" [formGroup]="registerForm" (ngSubmit)="submitRegister()" class="login-form">
      <label>Username</label>
      <input class="form-control" formControlName="username" />
      <div *ngIf="registerForm.controls['username'].touched && registerForm.controls['username'].invalid"
           class="error-text">Required.</div>

      <label>Email</label>
      <input type="email" class="form-control" formControlName="email" />
      <div *ngIf="registerForm.controls['email'].touched && registerForm.controls['email'].invalid"
           class="error-text">Valid email required.</div>

      <label>Password</label>
      <input type="password" class="form-control" formControlName="password" />
      <div *ngIf="registerForm.controls['password'].touched && registerForm.controls['password'].invalid"
           class="error-text">Min 8 characters, one lowercase, uppercase, and digit.</div>

      <label>Confirm Password</label>
      <input type="password" class="form-control" formControlName="confirmPassword" />
      <div *ngIf="registerForm.errors?.['mismatch'] && registerForm.touched" class="error-text">
        Passwords do not match.
      </div>

      <button class="btn btn-success w-100" type="submit">
        Register
      </button>
    </form>

    <div *ngIf="errorMessage" class="alert alert-danger mt-3 mb-0">{{ errorMessage }}</div>
  </div>
</div>
